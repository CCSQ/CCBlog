var connection = require('../dbConnection')

var initDbUtil = {}
var util = require('../../util')

var password = util.string2md5("admin")

initDbUtil.init = function () {
	var promise = new Promise(function (resolve, reject) {
		var sqlList = [
			// 导航表
			'DROP TABLE IF EXISTS sys_navlist',
			'CREATE TABLE sys_navlist (ID int(11) NOT NULL AUTO_INCREMENT,pageName varchar(255) DEFAULT NULL,pagType varchar(255) DEFAULT NULL,linkName varchar(255) DEFAULT "Main",PRIMARY KEY (ID))',
			'INSERT INTO sys_navlist VALUES ("1", "java", "java", "ArticleMain");',
			'INSERT INTO sys_navlist VALUES ("2", "temp", "temp", "ArticleMain");',

			// 用户表
			'DROP TABLE IF EXISTS sys_user',
			'CREATE TABLE sys_user (ID int(11) NOT NULL AUTO_INCREMENT,loginName varchar(255) DEFAULT NULL,passWord varchar(255) DEFAULT NULL,PRIMARY KEY (ID))',
			'INSERT INTO `sys_user` VALUES ("1", "admin", "'+password+'");',

			// 文章类型表
			'DROP TABLE IF EXISTS sys_article_type',
			'CREATE TABLE sys_article_type (ID int(11) NOT NULL AUTO_INCREMENT,type varchar(255) DEFAULT NULL,name varchar(255) DEFAULT NULL,isShow int(11) DEFAULT NULL,PRIMARY KEY (ID))',
			'INSERT INTO sys_article_type VALUES ("1", "none", "未分类",1);',
			'INSERT INTO sys_article_type VALUES ("2", "java", "Java",1);',
			'INSERT INTO sys_article_type VALUES ("3", "other", "其他",1);',

			// 文章表
			'DROP TABLE IF EXISTS sys_article',
			'CREATE TABLE sys_article (ID int(11) NOT NULL AUTO_INCREMENT,type varchar(255) DEFAULT NULL,createTime datetime DEFAULT NULL,updateTime datetime DEFAULT NULL,password varchar(255) DEFAULT NULL,private int(11) DEFAULT NULL,infor varchar(255) DEFAULT NULL,content blob DEFAULT NULL,title varchar(255) DEFAULT NULL,lastRely datetime DEFAULT NULL,relyNumber int(11) DEFAULT NULL,browseNumber int(11) DEFAULT NULL,tags varchar(255) DEFAULT NULL,isShow int(11) DEFAULT NULL,edicValue blob DEFAULT NULL,PRIMARY KEY (ID))',
			"INSERT INTO sys_article VALUES ('1', 'java', '2017-04-27 11:17:44', '2017-04-27 11:17:44', 'e10adc3949ba59abbe56e057f20f883e', '1', '    也许你不信，但事实就是这样子的，', 0x3C7072653E3C636F64653EE4B99FE8AEB8E4BDA0E4B88DE4BFA1EFBC8CE4BD86E4BA8BE5AE9EE5B0B1E698AFE8BF99E6A0B7E5AD90E79A84EFBC8CE58FAFE883BDE5939FE38082E38082E380820A3C2F636F64653E3C2F7072653E0A3C703EE8BF99E4BC9AE4B88DE4BC9AE698AFE585B6E4BB96E997AEE9A298E591A2EFBC9FEFBC9FEFBC9FEFBC9F3C2F703E0A, '第一篇文章', '0000-00-00 00:00:00', '0', '0', '首文,java,图片', '0', 0x20202020E4B99FE8AEB8E4BDA0E4B88DE4BFA1EFBC8CE4BD86E4BA8BE5AE9EE5B0B1E698AFE8BF99E6A0B7E5AD90E79A84EFBC8CE58FAFE883BDE5939FE38082E38082E380820AE8BF99E4BC9AE4B88DE4BC9AE698AFE585B6E4BB96E997AEE9A298E591A2EFBC9FEFBC9FEFBC9FEFBC9F0A0A0A0A);",
			"INSERT INTO sys_article VALUES ('2', 'other', '2017-04-27 11:23:30', '2017-04-27 11:23:30', '', '0', '![](http://127.0.0.1', 0x3C703E3C696D67207372633D22687474703A2F2F3132372E302E302E313A333030302F254536253936253837254534254242254236254535254134254239322F31302E69636F2220616C743D2222202F3E3C2F703E0A, '第二篇文章，没错我要直接上题目', '0000-00-00 00:00:00', '0', '0', '', '0', 0x215B5D28687474703A2F2F3132372E302E302E313A333030302FE69687E4BBB6E5A4B9322F31302E69636F29);",
			"INSERT INTO sys_article VALUES ('3', 'java', '2017-04-27 11:25:16', '2017-04-27 11:27:23', '', '0', '哈哈哈哈哈，这篇就厉害了、我的超长文本、', 0x3C703EE59388E59388E59388E59388E59388EFBC8CE8BF99E7AF87E5B0B1E58E89E5AEB3E4BA86E38081E68891E79A84E8B685E995BFE69687E69CACE38081E5BA94E8AFA5E883BDE5AD98E79A84E4B88BE68A8AEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FE585B6E5AE9EE68891E4B99FE4B88DE6B885E6A59AE5958AE5958AE5958AE5958AE5958AE5958AE5958AE5958A2031313131313131313131313131313131313131313C6272202F3E0A3C696D67207372633D22687474703A2F2F3132372E302E302E313A333030302F254536253936253837254534254242254236254535254134254239322F31302E69636F2220616C743D2222202F3E3C2F703E0A3C70726520636C6173733D22686C6A73223E3C636F646520636C6173733D226A617661223E53797374656D2E6F75742E7072696E74283C7370616E20636C6173733D22686C6A732D737472696E67223E2268656C6C6F20776F7264223C2F7370616E3E293B0A3C2F636F64653E3C2F7072653E0A3C703EE5A5BDE590A7EFBC8CE68891E8AEA4E8BE933C2F703E0A, '第三篇文章', '0000-00-00 00:00:00', '0', '0', '没啥标签', '1', 0xE59388E59388E59388E59388E59388EFBC8CE8BF99E7AF87E5B0B1E58E89E5AEB3E4BA86E38081E68891E79A84E8B685E995BFE69687E69CACE38081E5BA94E8AFA5E883BDE5AD98E79A84E4B88BE68A8AEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FEFBC9FE585B6E5AE9EE68891E4B99FE4B88DE6B885E6A59AE5958AE5958AE5958AE5958AE5958AE5958AE5958AE5958A2031313131313131313131313131313131313131310A215B5D28687474703A2F2F3132372E302E302E313A333030302FE69687E4BBB6E5A4B9322F31302E69636F290A6060606A6176610A53797374656D2E6F75742E7072696E74282268656C6C6F20776F726422293B0A6060600A);",
			
			// 设置表
			'DROP TABLE IF EXISTS sys_set',
			'CREATE TABLE sys_set (ID int(11) NOT NULL AUTO_INCREMENT,name varchar(255) DEFAULT NULL,param varchar(255) DEFAULT NULL,PRIMARY KEY (ID))',
			"INSERT INTO sys_set(ID,name,param) VALUES (0, 'logoUrl', 'http://127.0.0.1:3000/logo/11.ico');",
			"INSERT INTO sys_set(ID,name,param) VALUES (0, 'title', 'CCBlog');",
			"INSERT INTO sys_set(ID,name,param) VALUES (0, 'infor', 'Web');",

			// 用户表
			'DROP TABLE IF EXISTS sys_brow_user',
			'CREATE TABLE sys_brow_user (ID int(11) NOT NULL AUTO_INCREMENT,eMain varchar(255) DEFAULT NULL,name varchar(255) DEFAULT NULL,PRIMARY KEY (ID))',
			'INSERT INTO sys_brow_user VALUES ("0", "1@qq.com", "CC");',
			'INSERT INTO sys_brow_user VALUES ("0", "2@qq.com", "C.C");',
			'INSERT INTO sys_brow_user VALUES ("0", "3@qq.com", "YY");',

			// 评论表，articId 为0时代表留言
			'DROP TABLE IF EXISTS sys_comment',
			'CREATE TABLE sys_comment (ID int(11) NOT NULL AUTO_INCREMENT,content varchar(255) DEFAULT NULL,articId int(11) DEFAULT NULL,rePlayId int(11) DEFAULT NULL,userId int(11),createTime datetime DEFAULT NULL,isShow int(11) DEFAULT 1,PRIMARY KEY (ID))',
			// 'INSERT INTO sys_comment VALUES ("0", "你好", 3, 0, 1);',
			'insert into sys_comment(ID,content,articId,rePlayId,userId,createTime) values ("0", "你好", 3, 0, 1, "2017-04-27 11:17:44")',
			// 'INSERT INTO sys_comment VALUES ("0", "2你好", 3, 0, 1);',
			// 'INSERT INTO sys_comment VALUES ("0", "3@你好com", "3, 0, 1);',

		]
		connection.connect(function () {
			for (var i = 0; i < sqlList.length; i++) {
				connection.query(sqlList[i])
			}
		})
	})
	return promise
}



module.exports = initDbUtil